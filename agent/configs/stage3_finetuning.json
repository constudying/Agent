{
  "algo_name": "agent",
  "experiment": {
    "name": "test",
    "validate": true,
    "logging": {
      "terminal_output_to_txt": true,
      "log_tb": true
    },
    "save": {
      "enabled": true,
      "every_n_seconds": null,
      "every_n_epochs": 50,
      "epochs": [],
      "on_best_validation": true,
      "on_best_rollout_return": false,
      "on_best_rollout_success_rate": true
    },
    "epoch_every_n_steps": 100,
    "validation_epoch_every_n_steps": 10,
    "env": null,
    "additional_envs": null,
    "render": false,
    "render_video": true,
    "keep_all_videos": false,
    "video_skip": 5,
    "rollout": {
      "enabled": false,
      "n": 10,
      "horizon": 1600,
      "rate": 10,
      "warmstart": 0,
      "terminate_on_success": true
    }
  },
  "train": {
    "data": null,
    "output_dir": "../trained_models_highlevel",
    "num_data_workers": 2,
    "hdf5_cache_mode": "low_dim",
    "hdf5_use_swmr": true,
    "hdf5_normalize_obs": false,
    "hdf5_load_next_obs": false,
    "hdf5_filter_key": "train",
    "hdf5_validation_filter_key": "valid",
    "seq_length": 1,
    "dataset_keys": [
      "actions",
      "rewards",
      "done"
    ],
    "goal_mode": "nstep",
    "cuda": true,
    "batch_size": 32,
    "num_epochs": 500,
    "seed": 1
  },
  "algo": {
    "optim_params": {
      "policy": {
        "learning_rate": {
          "initial": 0.0001,
          "decay_factor": 0.1,
          "epoch_schedule": []
        },
        "regularization": {
          "L2": 0.0
        }
      }
    },
    "loss": {
      "l2_weight": 1.0,
      "l1_weight": 0.4,
      "cos_weight": 0.0
    },
    "actor_layer_dims": [
      400,
      128,
      7
    ],
    "transformer": {
      "enabled": true,
      "embed_dim": 128,
      "num_layers": 4,
      "num_heads": 4,
      "context_length": 32,
      "attn_dropout": 0.1,
      "output_dropout": 0.1,
      "transformer_sinusoidal_embedding": false,
      "activation": "relu",
      "causal": false,
      "transformer_nn_parameter_for_timesteps": false
    },
    "highlevel": {
      "enabled": true,
      "ac_dim": 30,
      "latent_plan_dim": 400
    },
    "lowlevel": {
      "enabled": true,
      "feat_dim": 656,
      "trained_highlevel_planner": "",
      "eval_goal_img_window": 30,
      "eval_max_goal_img_iter": 5
    },
    "playdata": {
      "enabled": true,
      "goal_image_range": [
        100,
        200
      ],
      "eval_goal_gap": 150
    }
  },
  "observation": {
    "modalities": {
      "obs": {
        "low_dim": [
          "robot0_eef_pos",
          "robot0_eef_pos_future_traj"
        ],
        "rgb": [
          "agentview_image"
        ],
        "depth": [],
        "scan": []
      },
      "goal": {
        "low_dim": [],
        "rgb": [
          "agentview_image"
        ],
        "depth": [],
        "scan": []
      }
    },
    "encoder": {
      "low_dim": {
        "core_class": null,
        "core_kwargs": {},
        "obs_randomizer_class": null,
        "obs_randomizer_kwargs": {}
      },
      "rgb": {
        "core_class": "AgentVisualCore",
        "core_kwargs": {
          "feature_dimension": 64,
          "flatten": true,
          "backbone_class": "ResNetFiLM",
          "backbone_kwargs": {
            "pretrained": false,
            "input_channels": 3,
            "film_net_class": "mlp",
            "film_net_kwargs": {
              "obs_shapes": 512,
              "layer_dims": [
                256,
                128,
                2
              ],
              "layer_func": "linear",
              "activation": "relu"
            },
            "conv_layer_num": 1,
            "net_params": {
              "block1": {
                "conv1_params": {
                  "in_channels": 3,
                  "out_channels": 32,
                  "kernel_size": 3,
                  "stride": 2,
                  "padding": 1
                },
                "conv2_params": {
                  "in_channels": 32,
                  "out_channels": 64,
                  "kernel_size": 3,
                  "stride": 1,
                  "padding": 1
                },
                "shortcut_params": {
                  "in_channels": 3,
                  "out_channels": 64,
                  "kernel_size": 1,
                  "stride": 2,
                  "padding": 0
                },
                "film_enabled": true
              }
            },
            "activation": "relu",
            "input_coord_conv": false
          },
          "pool_class": null,
          "pool_kwargs": {
            "num_kp": 32,
            "learnable_temperature": false,
            "temperature": 1.0,
            "noise_std": 0.0,
            "output_variance": false
          }
        },
        "obs_randomizer_class": null,
        "obs_randomizer_kwargs": {}
      },
      "depth": {
        "core_class": null,
        "core_kwargs": {},
        "obs_randomizer_class": null,
        "obs_randomizer_kwargs": {}
      },
      "scan": {
        "core_class": null,
        "core_kwargs": {},
        "obs_randomizer_class": null,
        "obs_randomizer_kwargs": {}
      }
    }
  }
}